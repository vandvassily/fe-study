# TCP

传输控制协议（TCP，Transmission Control Protocol），是一种面向连接的、可靠的、基于字节流的传输层通信协议

[TCP -- 百度百科](https://baike.baidu.com/item/TCP/33012)

## TCP头部

共 20 字节

## 主要特点

1. 基于字节流
2. 面向连接
3. 可靠的通信方式
4. 在网络状况不佳的时候尽量降低系统由于重传带来的带宽开销

为满足TCP协议的这些特点，TCP协议做了如下的规定：

1. 数据分片：在发送端对用户数据进行分片，在接收端进行重组，由TCP确定分片的大小并控制分片和重组；
2. 到达确认：接收端接收到分片数据时，根据分片数据序号向发送端发送一个确认；
3. 超时重发：发送方在发送分片时启动超时定时器，如果在定时器超时之后没有收到相应的确认，重发分片；
4. 滑动窗口：TCP连接每一方的接收缓冲空间大小都固定，接收端只允许另一端发送接收端缓冲区所能接纳的数据，TCP在滑动窗口的基础上提供流量控制，防止较快主机致使较慢主机的缓冲区溢出；
5. 失序处理：作为IP数据报来传输的TCP分片到达时可能会失序，TCP将对收到的数据进行重新排序，将收到的数据以正确的顺序交给应用层；
6. 重复处理：作为IP数据报来传输的TCP分片会发生重复，TCP的接收端必须丢弃重复的数据；
7. 数据校验：TCP将保持它首部和数据的检验和，这是一个端到端的检验和，目的是检测数据在传输过程中的任何变化。如果收到分片的检验和有差错，TCP将丢弃这个分片，并不确认收到此报文段导致对端超时并重发。

## TCP连接

TCP，使用三次握手（Three-way Handshake）来建立连接，需要客户端和服务端总共发送3个包以确认连接的建立。

## 终止TCP连接

使用四次挥手（Four-way Wavehand）终止连接。断开一个TCP连接时，需要客户端和服务端总共发送4个包以确认连接的断开。

## 参考

[TCP -- 百度百科](https://baike.baidu.com/item/TCP/33012)

[TCP协议详解](https://www.jianshu.com/p/ef892323e68f)